# ===========================
# 在线训练配置 - 批量特征提取模式
# ===========================
# 适用场景: 在线训练需要更大的有效batchsize
# 速度: 中（批量提取特征，提升GPU利用率）
# 优点: batchsize真正生效，提升训练效率

# 数据路径
data:
  raw_data_root: raw_data            # 原始数据根目录（包含HDF5文件）
  camera_name: head_camera           # 相机名称
  
  # 任务列表
  tasks: 
    - beat_block_hammer
  
  # 数据采样
  horizon: 8          # 预测未来 8 步
  n_obs_steps: 2      # 观测 2 帧
  
  # 双臂配置
  use_left_arm: true
  use_right_arm: true
  fuse_arms: true
  include_gripper: false

# 对齐编码器
encoder:
  checkpoint: /home/gl/features_model/outputs/train_rgb2pc_runs/run_best_bs32/ckpt_step_0010000.pt
  freeze: true  # 冻结对齐编码器

# 训练配置
train:
  epochs: 500
  batch_size: 4      # ✓ 批量提取模式下可以使用更大的batchsize (8-32)
  batch_extract: true # ★ 关键参数: 启用批量特征提取模式
  lr: 1e-4
  num_workers: 0      # 批量模式下可以使用多worker
  
  # 优化器
  optimizer: adamw
  weight_decay: 1e-6

# 策略网络
policy:
  type: OfficialDP    # 策略类型: SimpleMLP | OfficialDP
  hidden_dim: 512
  
  # 正版DP配置（当type=OfficialDP时生效）
  use_official_dp: true  # 是否使用正版Diffusion Policy
  num_inference_steps: 100  # 扩散推理步数

# 设备配置
device:
  gpu_ids: [0, 1] 

# 输出
output:
  dir: _runs/online_training
  save_every_n_epochs: 50
  run_name: null  # null = 自动生成

debug:
  print_config: true
  fast_dev_run: false  # true: 只跑1个batch用于快速调试
