# configs/train_dp_rgb_dual_2.yaml
# 双臂任务 (action_dim=2, 左+右各1维)
# 2 个任务: stack_bowls_two, place_burger_fries

# ============================================================
# 数据配置
# ============================================================

rgb_zarr_roots:
  - /home/gl/features_model/rgb_dataset/features_croco_encoder_dict_unified_zarr

traj_root: /home/gl/features_model/raw_data

# 双臂任务
tasks:
  - stack_bowls_two-demo_randomized-20_head_camera
  - place_burger_fries-demo_randomized-20_head_camera

# ============================================================
# Policy 配置
# ============================================================

rgb_ckpt_path: /home/gl/features_model/outputs/train_rgb2pc_runs/run_best_bs32/ckpt_step_0010000.pt
freeze_encoder: true

horizon: 16
n_obs_steps: 2
n_action_steps: 8
obs_encoder_dim: 256
obs_as_global_cond: true

# ============================================================
# 机械臂配置（双臂融合）
# ============================================================

use_left_arm: true
use_right_arm: true
fuse_arms: true  # concat 左右臂动作 -> action_dim=2

# ============================================================
# 训练配置
# ============================================================

device: cuda
epochs: 100
batch_size: 32
num_workers: 8
lr: 1.0e-4
betas: [0.95, 0.999]
eps: 1.0e-8
weight_decay: 1.0e-6

amp: true
grad_accum_steps: 1

pad_before: 0
pad_after: 0
seed: 42

# ============================================================
# 日志与保存
# ============================================================

save_dir: /home/gl/features_model/outputs/dp_rgb_runs/dual_2
save_every: 10
log_every: 50

tqdm: true

wandb: false
wandb_project: dp_rgb
wandb_entity: ""
wandb_run_name: dp_rgb_dual_2
